# import-html-entry

- 作用：代替 system.js 功能，去实现加载子应用，并解析出 template、script、css

## 前置

- 大量使用正则表达式来处理
- [\s\S] 表示任意字符包含换行 \n
- /s 修饰符 搭配 . 的时候可以匹配任意字符且包含换行\n

- 修饰符
  - /g 全局
  - /i 忽略大小写
  - /m 多行匹配
  - /s 搭配.时会匹配任务字符且包含换行\n
  - /y 粘性 对 exec 的 lastIndex 严格匹配
- 边界 \b
- 范围 []
  - IE 不支持 unicode 属性，需要使用 XRegExp 做兼容
    - 多年来，他的命名捕获、等功能被 RegExp 收纳实现
  - 包含 [a-z]
  - 不包含 ^
    - [^0-9] 同 \D
  - 不需要转义
    - [-().^+]
    - 为了以防万一转义他们 也不会存在问题
- 量词
- 正则表达式引擎算法
  - 贪婪模式
    - 默认启用
    - 尽可能多的匹配量词
    - .+
    - 先贪婪搜索，再回溯
  - 惰性模式
    - 仅对带有?的量词启用
    - .+?
    - 找到就停止
  - 惰性模式不是贪婪模式的灵丹妙药，需要使用排除项进行微调贪婪模式，比如/"[^"]*"/
- 分组
  - 捕获分组
    - matchAll
  - 命名分组
  - 非捕获分组
- 反向引用
  - 按捕获顺序 \Number
  - 按命名 \k<Name>
- 或 |
- 前瞻断言、后瞻断言
  - 肯定前瞻 x(?=y) 匹配后面紧跟着 y 的 x
  - 否定前瞻 x(?!y) 匹配后面不是 y 的 x
  - 肯定后瞻 (?<=x)y 匹配前面是 x 的 y
  - 否定后瞻 (?<!x)y 匹配前面不是 x 的 y
- 灾难性回溯
  - 出现场景及原因
    - 嵌套量词时 (x+)*
    - `+` 会默认触发贪婪模式
    - 没有匹配到时，会递归回溯
  - 递归回溯，会尝试找出所有的排列组合方式，会做很多人类一眼看上去是错误的判断，直到结束
  - 解决灾难性回溯问题
    - 重写正则表达式，尽可能降低可能得组合数量
    - 防止回溯
      - 占有型量词
        - 在后面添加`+`
        - Java 支持，JavaScript 不支持
      - 前瞻断言
        - 使用 (?=(?<word>x))\k<word>
          - (?=x) 前瞻断言 不会放入捕获分组
          - (?<word>x) 命名捕获分组 会放入捕获分组
          - \k(word) 使用命名捕获分组 消耗捕获分组
        - 上面 x 可以替换为其他复杂的正则表达式

## 资料

- [正则表达式详解](https://zh.javascript.info/regular-expressions)
